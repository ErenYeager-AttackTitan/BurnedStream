<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Search</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body { background: #111; color: white; }
    .poster { border-radius: 0.75rem; object-fit: cover; aspect-ratio: 2/3; }
  </style>
</head>
<body>
  <div class="p-6">
    <h1 class="text-2xl font-bold mb-4">Search</h1>
    <input type="text" id="searchBox" placeholder="Search movies or series..." 
      class="w-full p-3 rounded bg-gray-900 text-white mb-6 outline-none" />
    <div id="results" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-5 lg:grid-cols-6 gap-6"></div>
  </div>

  <script>
    async function fetchAll() {
      const [moviesRes, seriesRes] = await Promise.all([
        fetch("https://crew-auth.vercel.app/api/content"),
        fetch("https://crew-auth.vercel.app/api/series")
      ]);
      return [...await moviesRes.json(), ...await seriesRes.json()];
    }

    document.getElementById("searchBox").addEventListener("input", async (e) => {
      const query = e.target.value.toLowerCase();
      const all = await fetchAll();
      const results = all.filter(i => i.title.toLowerCase().includes(query));
      const container = document.getElementById("results");
      container.innerHTML = "";
      results.forEach(item => {
        const div = document.createElement("div");
        div.innerHTML = `
          <a href="watch.html?id=${item._id}&type=${item.type}">
            <img src="${item.posterLow || item.poster}" alt="${item.title}" class="poster w-full">
            <p class="mt-2 text-sm text-gray-300 truncate">${item.title}</p>
          </a>
        `;
        container.appendChild(div);
      });
    });
  </script>
</body>
</html>
