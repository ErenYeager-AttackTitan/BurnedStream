<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>RyuuApp - Watch</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body { background:#0f0f0f; color:#fff; font-family: 'Inter', sans-serif; }
    iframe { border:0; width:100%; aspect-ratio:16/9; border-radius:0.75rem; }
    .backdrop {
      position: absolute;
      top:0; left:0; width:100%; height:100%;
      background-size:cover; background-position:center;
      filter: blur(30px) brightness(0.4);
      z-index:-1;
    }
  </style>
</head>
<body class="min-h-screen flex flex-col relative">

  <!-- Backdrop -->
  <div id="backdrop" class="backdrop"></div>

  <!-- Header -->
  <header class="p-4 bg-black/60 backdrop-blur-md flex justify-between items-center sticky top-0 z-10 shadow-md">
    <h1 class="text-lg font-bold">Watch</h1>
    <a href="index.html" class="px-3 py-2 rounded-lg bg-gray-700 text-sm font-semibold hover:bg-gray-600 transition">
      Home
    </a>
  </header>

  <!-- Player -->
  <main class="flex-1 p-4 pb-24">
    <div id="player" class="rounded-xl overflow-hidden shadow-lg mb-4"></div>

    <!-- Info -->
    <h2 id="title" class="text-xl font-bold mb-2"></h2>
    <p id="desc" class="text-sm opacity-80 mb-3"></p>
    <img id="poster" class="w-28 rounded-lg mb-4 shadow-lg"/>

    <!-- Episodes -->
    <div id="episodes" class="flex flex-wrap gap-2"></div>
  </main>

  <!-- Bottom Nav -->
  <nav class="bg-black/80 backdrop-blur-md border-t border-gray-800 fixed bottom-0 w-full flex justify-around items-center py-2 text-gray-400">
    <a href="index.html" class="flex flex-col items-center hover:text-white">
      <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 mb-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 9.75L12 4l9 5.75v10.5A2.75 2.75 0 0118.25 23H5.75A2.75 2.75 0 013 20.25V9.75z" />
      </svg>
      <span class="text-xs">Home</span>
    </a>
    <a href="search.html" class="flex flex-col items-center hover:text-white">
      <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 mb-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-4.35-4.35m0 0A7.5 7.5 0 1010.5 18.5a7.5 7.5 0 006.15-3.85z" />
      </svg>
      <span class="text-xs">Search</span>
    </a>
    <a href="#" class="flex flex-col items-center hover:text-white">
      <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 mb-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12H9m12 0a9 9 0 11-18 0 9 9 0 0118 0z" />
      </svg>
      <span class="text-xs">Profile</span>
    </a>
  </nav>

  <script>
    const API="https://crew-auth.vercel.app";
    const params=new URLSearchParams(location.search);
    const id=params.get("id");
    const type=params.get("type");

    async function load(){
      const url=type==="tv"?`${API}/api/series/${id}`:`${API}/api/content/${id}`;
      const res=await fetch(url);
      const item=await res.json();

      document.getElementById("title").innerText=item.title;
      document.getElementById("desc").innerText=item.description || "";
      document.getElementById("poster").src=item.posterLow||item.poster;

      // Backdrop
      document.getElementById("backdrop").style.backgroundImage=`url('${item.backdropHigh||item.backdropLow}')`;

      // Player
      if(type==="movie"){
        document.getElementById("player").innerHTML=`
          <iframe src="${item.slug}" allowfullscreen></iframe>`;
      } else {
        const epDiv=document.getElementById("episodes");
        epDiv.innerHTML="";
        item.episodes.forEach(ep=>{
          const btn=document.createElement("button");
          btn.className="px-3 py-1 rounded-full bg-gray-800 hover:bg-red-600 text-sm transition";
          btn.innerText="Ep "+ep.ep;
          btn.onclick=()=>{
            document.getElementById("player").innerHTML=`
              <iframe src="${ep.slug}" allowfullscreen></iframe>`;
          };
          epDiv.appendChild(btn);
        });
        // Load first ep by default
        if(item.episodes.length>0){
          document.getElementById("player").innerHTML=`
            <iframe src="${item.episodes[0].slug}" allowfullscreen></iframe>`;
        }
      }
    }
    load();
  </script>
</body>
  </html>
  
