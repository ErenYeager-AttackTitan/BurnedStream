<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Watch Match</title>
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdn.jsdelivr.net/npm/video.js@8.6.1/dist/video.min.js"></script>
<link href="https://cdn.jsdelivr.net/npm/video.js@8.6.1/dist/video-js.min.css" rel="stylesheet" />
<style>
  body { background: #0f172a; color: #f8fafc; }
  .vjs-big-play-centered { background: #2563eb; }
  .btn-toggle { transition: background 0.3s; }
  .btn-toggle:hover { background: #2563eb; color: white; }
</style>
</head>
<body class="flex flex-col items-center p-4">

<header class="text-center mb-4">
  <h1 class="text-2xl font-bold text-blue-400">ðŸ“º FanCode Streaming</h1>
</header>

<!-- Video Player -->
<video id="videoPlayer" class="video-js vjs-big-play-centered w-full max-w-3xl rounded-lg overflow-hidden shadow-lg" controls autoplay preload="auto"></video>

<h2 id="matchTitle" class="mt-4 text-center text-lg font-semibold"></h2>

<div id="info" class="mt-2 text-center text-sm text-gray-400"></div>

<!-- Stream Switch Buttons -->
<div class="mt-4 flex gap-2">
  <button id="btnDai" class="btn-toggle px-4 py-2 bg-gray-700 rounded font-semibold">DAI Stream</button>
  <button id="btnAdfree" class="btn-toggle px-4 py-2 bg-gray-700 rounded font-semibold">AdFree Stream</button>
</div>

<script>
const API_URL = "https://raw.githubusercontent.com/drmlive/fancode-live-events/refs/heads/main/fancode.json";
const urlParams = new URLSearchParams(window.location.search);
const matchId = urlParams.get("id");

let player, matchData;

async function loadMatch() {
  const res = await fetch(API_URL);
  const data = await res.json();
  matchData = data.matches.find(m => m.match_id == matchId);

  if(!matchData) {
    document.body.innerHTML = "<p class='text-red-500 text-lg'>Match not found!</p>";
    return;
  }

  document.getElementById("matchTitle").innerText = matchData.title;
  document.getElementById("info").innerHTML = `
    ${matchData.team_1} ðŸ†š ${matchData.team_2} | ${matchData.event_name} | Status: <span class="${matchData.status==='LIVE'?'text-red-400':'text-blue-400'} font-semibold">${matchData.status}</span>
  `;

  player = videojs("videoPlayer");
  player.src({ src: matchData.adfree_url || matchData.dai_url, type: "application/x-mpegURL" });
  player.play();
}

// Switch Stream
document.getElementById("btnDai").addEventListener("click", () => {
  if(matchData.dai_url) {
    player.src({ src: matchData.dai_url, type: "application/x-mpegURL" });
    player.play();
  }
});

document.getElementById("btnAdfree").addEventListener("click", () => {
  if(matchData.adfree_url) {
    player.src({ src: matchData.adfree_url, type: "application/x-mpegURL" });
    player.play();
  }
});

loadMatch();
</script>
</body>
</html>
